import{u as a}from"./index-DKYL_AX4.js";import{s}from"./client-DgMJTZRL.js";import{m as i}from"./utils-B-GjzKLI.js";const f=async()=>{try{const{data:e,error:r}=await s.from("inventory_counts").select(`
        *,
        product:products(*)
      `).order("counted_at",{ascending:!1});if(r)throw console.error("Error fetching inventory counts:",r),a.error("Failed to fetch inventory counts"),r;return e.map(t=>({id:t.id,productId:t.product_id,product:t.product?i(t.product):void 0,count:t.count,countedAt:new Date(t.counted_at),countMethod:t.count_method,notes:t.notes||void 0}))}catch(e){throw console.error("Error in getInventoryCounts:",e),e}},v=async e=>{try{const r=e.map(o=>({product_id:o.productId,count:o.count,counted_at:o.countedAt.toISOString(),count_method:o.countMethod,notes:o.notes})),{data:t,error:n}=await s.from("inventory_counts").insert(r).select(`
        *,
        product:products(*)
      `);if(n)throw console.error("Error adding bulk inventory counts:",n),a.error("Failed to add inventory counts"),n;return a.success(`${t.length} inventory counts added successfully`),t.map(o=>({id:o.id,productId:o.product_id,product:o.product?i(o.product):void 0,count:o.count,countedAt:new Date(o.counted_at),countMethod:o.count_method,notes:o.notes||void 0}))}catch(r){throw console.error("Error in addInventoryCounts:",r),r}},w=async e=>{try{const r=new FormData;r.append("file",e);const{data:t,error:n}=await s.functions.invoke("process-inventory",{body:r});if(n)throw console.error("Error processing inventory video:",n),new Error(n.message);const{data:o,error:d}=await s.from("products").select("*");if(d)throw console.error("Error fetching products for matching:",d),d;return t.items.map(c=>({productId:o?.find(u=>u.name.toLowerCase().includes(c.name.toLowerCase())||c.name.toLowerCase().includes(u.name.toLowerCase()))?.id||"",name:c.name,count:c.count,confidence:.8+Math.random()*.2})).filter(c=>c.productId!=="")}catch(r){throw console.error("Error in processInventoryVideo:",r),r}};export{v as a,f as g,w as p};
//# sourceMappingURL=inventoryService-DdHjgH4d.js.map
