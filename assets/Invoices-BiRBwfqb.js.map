{"version":3,"file":"Invoices-BiRBwfqb.js","sources":["../../src/pages/Invoices.tsx"],"sourcesContent":["import { useState } from \"react\";\nimport Layout from \"@/components/layout/Layout\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Invoice } from \"@/types/inventory\";\nimport { Search, Plus, FileText, ChevronDown, ChevronUp, Database } from \"lucide-react\";\nimport { useQuery, useQueryClient } from \"@tanstack/react-query\";\nimport { getInvoices, loadMockInvoices } from \"@/services/apiService\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { format } from \"date-fns\";\nimport { Link } from \"react-router-dom\";\nimport { toast } from \"sonner\";\n\nconst Invoices = () => {\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const queryClient = useQueryClient();\n  \n  const { data: invoices = [], isLoading } = useQuery({\n    queryKey: [\"invoices\"],\n    queryFn: getInvoices\n  });\n  \n  const handleLoadMockData = async () => {\n    try {\n      await loadMockInvoices();\n      // Refresh the invoices list\n      queryClient.invalidateQueries({ queryKey: [\"invoices\"] });\n    } catch (error) {\n      console.error(\"Error loading mock data:\", error);\n    }\n  };\n  \n  // Filter invoices based on search\n  const filteredInvoices = invoices.filter(invoice => \n    invoice.supplierName.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    invoice.invoiceNumber.toLowerCase().includes(searchQuery.toLowerCase())\n  );\n  \n  // Sort invoices by date, newest first\n  const sortedInvoices = [...filteredInvoices].sort((a, b) => \n    new Date(b.date).getTime() - new Date(a.date).getTime()\n  );\n\n  return (\n    <Layout \n      title=\"Invoices\" \n      description=\"Track and manage supplier invoices\"\n    >\n      <div className=\"p-6\">\n        <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6\">\n          <div className=\"relative w-full sm:w-96\">\n            <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n            <Input \n              placeholder=\"Search invoices...\" \n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              className=\"pl-10\"\n            />\n          </div>\n          <div className=\"flex gap-2\">\n            <Button variant=\"outline\" onClick={handleLoadMockData}>\n              <Database className=\"mr-2 h-4 w-4\" />\n              Load Mock Data\n            </Button>\n            <Button asChild>\n              <Link to=\"/invoices/upload\">\n                <Plus className=\"mr-2 h-4 w-4\" />\n                Add Invoice\n              </Link>\n            </Button>\n          </div>\n        </div>\n\n        {isLoading ? (\n          <div className=\"space-y-4\">\n            {[...Array(3)].map((_, i) => (\n              <Skeleton key={i} className=\"h-24 w-full\" />\n            ))}\n          </div>\n        ) : filteredInvoices.length === 0 ? (\n          <Card>\n            <CardContent className=\"p-6 text-center\">\n              <p className=\"text-muted-foreground\">No invoices found</p>\n            </CardContent>\n          </Card>\n        ) : (\n          <Card>\n            <CardHeader>\n              <CardTitle>Recent Invoices</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-4\">\n                {sortedInvoices.map(invoice => (\n                  <InvoiceCard key={invoice.id} invoice={invoice} />\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n        )}\n      </div>\n    </Layout>\n  );\n};\n\ninterface InvoiceCardProps {\n  invoice: Invoice;\n}\n\nconst InvoiceCard = ({ invoice }: InvoiceCardProps) => {\n  const [isExpanded, setIsExpanded] = useState(false);\n\n  return (\n    <div className=\"border rounded-lg overflow-hidden\">\n      <div \n        className=\"p-4 bg-white cursor-pointer flex flex-col sm:flex-row items-start sm:items-center justify-between\"\n        onClick={() => setIsExpanded(!isExpanded)}\n      >\n        <div className=\"flex items-center gap-3 mb-2 sm:mb-0\">\n          <div className=\"h-10 w-10 rounded-full bg-restaurant-secondary flex items-center justify-center\">\n            <FileText className=\"h-5 w-5 text-restaurant\" />\n          </div>\n          <div>\n            <h3 className=\"font-medium\">{invoice.supplierName}</h3>\n            <p className=\"text-xs text-muted-foreground\">\n              #{invoice.invoiceNumber} â€¢ {format(new Date(invoice.date), \"MMM d, yyyy\")}\n            </p>\n          </div>\n        </div>\n        \n        <div className=\"flex items-center gap-4 sm:gap-8 w-full sm:w-auto justify-between sm:justify-start\">\n          <div>\n            <p className=\"text-xs text-muted-foreground\">Amount</p>\n            <p className=\"font-medium\">${invoice.total.toFixed(2)}</p>\n          </div>\n          \n          <div>\n            <p className=\"text-xs text-muted-foreground\">Status</p>\n            <div>\n              <Badge \n                variant=\"outline\" \n                className={\n                  invoice.paidStatus === \"paid\" ? \"bg-green-50 text-green-600 border-green-200\" :\n                  invoice.paidStatus === \"partial\" ? \"bg-yellow-50 text-yellow-600 border-yellow-200\" :\n                  \"bg-red-50 text-red-600 border-red-200\"\n                }\n              >\n                {invoice.paidStatus === \"paid\" ? \"Paid\" : \n                 invoice.paidStatus === \"partial\" ? \"Partial\" : \"Unpaid\"}\n              </Badge>\n            </div>\n          </div>\n          \n          <div className=\"text-muted-foreground\">\n            {isExpanded ? <ChevronUp size={18} /> : <ChevronDown size={18} />}\n          </div>\n        </div>\n      </div>\n      \n      {isExpanded && (\n        <div className=\"bg-gray-50 p-4 border-t\">\n          <h4 className=\"text-sm font-medium mb-2\">Items</h4>\n          <div className=\"space-y-2\">\n            {invoice.items.map((item, index) => (\n              <div key={index} className=\"flex justify-between text-sm\">\n                <span>\n                  {item.product?.name || \"Unknown Product\"} ({item.quantity} x ${item.unitPrice.toFixed(2)})\n                </span>\n                <span className=\"font-medium\">${item.total.toFixed(2)}</span>\n              </div>\n            ))}\n            <div className=\"pt-2 border-t flex justify-between text-sm font-medium\">\n              <span>Total</span>\n              <span>${invoice.total.toFixed(2)}</span>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default Invoices;\n"],"names":["Invoices","searchQuery","setSearchQuery","useState","queryClient","useQueryClient","invoices","isLoading","useQuery","getInvoices","handleLoadMockData","loadMockInvoices","error","filteredInvoices","invoice","sortedInvoices","b","jsx","Layout","jsxs","Search","Input","e","Button","Database","Link","Plus","_","i","Skeleton","Card","CardContent","CardHeader","CardTitle","InvoiceCard","isExpanded","setIsExpanded","FileText","format","Badge","ChevronUp","ChevronDown","item","index"],"mappings":"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"}